#   _                                          __
#  | |_ _ __ ___  _   ___  __  ___ ___  _ __  / _|
#  | __| '_ ` _ \| | | \ \/ / / __/ _ \| '_ \| |_
#  | |_| | | | | | |_| |>  < | (_| (_) | | | |  _|
# (_)__|_| |_| |_|\__,_/_/\_(_)___\___/|_| |_|_|
# Config for Tmux (C) 2016-2025 Gordon Engelke, reject@email.de

# General:
# C-a           Prefix
# C-a   r       Source .tmux.conf
# C-a   ?       Show key bindings
# C-a   t       Show time
#
# Sessions:
# C-a   s       List sessions
# C-a   $       Rename session
#
# Windows (tabs):
# C-a   c       Create window
# C-a   w       List windows
# C-a   f       Find window
# C-a   ,       Name window
# C-a   &       Kill window
#
# Panes (splits):
# C-a   |       Vertical split
# C-a   -       Horizontal split
# C-a   o       Jump between panes
# C-a   q       Show pane numbers (type number to jump)
# C-a   x       Kill pane
# C-a   !       Break pane out into a window
# C-a   j       Create pane from an existing window
# C-a   arrow   Move between panes

###################################
## Screen-like keybindings
###################################

unbind C-b
set -g prefix C-a
# For nested sessions, C-a a sends a command to the inner session
bind-key a send-prefix
bind-key C-a last-window
unbind space
bind-key space next-window
bind-key C-space next-window
bind-key K confirm-before kill-pane
#bind-key \ confirm-before kill-session
#bind-key C-h previous-window
bind-key tab select-pane -t :.+

###################################
## Enable copy (ctrl-a,[ and then v/y like in VIM) and paste (ctrl-P)
###################################

bind P paste-buffer
#bind-key -t vi-copy 'v' begin-selection
#bind-key -t vi-copy 'y' copy-selection
#bind-key -t vi-copy 'r' rectangle-toggle

###################################
## Window navigation
###################################

bind '.' next
bind ',' prev

# Switch panes using Alt-arrow without prefix
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

###################################
## Bind pane splitting to more familiar keystrokes
###################################

bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

###################################
## Reload tmux config
###################################

unbind-key r
bind-key r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded"

###################################
## Misc
###################################

set-option -g default-shell /bin/bash
set -g display-panes-time 3000
set -g mode-keys vi

# Enable 256 colors mode
set -g default-terminal "screen-256color"

# More history
set -g history-limit 100000

# Remove key delays
set -sg escape-time 0

# Resize windows on larger screens
setw -g aggressive-resize on

# Workaround for weird escape code output as mentioned here: https://github.com/microsoft/terminal/issues/16384#issuecomment-1961268644
set -sg escape-time 1
set-option -s escape-time 50

#source "/usr/share/tmux/powerline.conf"

###################################
## Mouse support
###################################

set -g mouse on #newer versions
#setw -g mode-mouse on
#set -g mouse-select-pane on
#set -g mouse-resize-pane on
#set -g mouse-select-window on
#bind -n WheelUpPane copy-mode

###################################
## Activity
###################################

set-option -g visual-activity off
set-option -g visual-bell off
set-option -g visual-silence off
set-window-option -g monitor-activity off
set-option -g bell-action none
setw -g monitor-activity on
set -g visual-activity on

###################################
## Modes
###################################

setw -g clock-mode-colour colour135
#setw -g mode-attr bold
#setw -g mode-fg colour196
#setw -g mode-bg colour238

###################################
## Panes
###################################

#set -g pane-border-bg colour235
#set -g pane-border-fg colour238
#set -g pane-active-border-bg colour236
#set -g pane-active-border-fg colour51

# Start window and pane numbering at 1 instead of 0
set -g base-index 1
setw -g pane-base-index 1
set-option -g renumber-windows on

###################################
## Statusbar
###################################

set -g status-justify centre # center align window list
set -g status-bg default
set -g status-fg colour12
set -g status-interval 2

# Put useful info in the status bar
set-option -g set-titles on
set-option -g set-titles-string '#H:#S.#I.#P #W #T' # window number,program name, active(or not)

set -g status-position bottom
set -g status-bg colour234
set -g status-fg colour137

# Right side of status bar
set -g status-right '#[fg=colour244,bg=colour234] %d-%m-%y #[fg=colour244] %H:%M:%S '
set -g status-right-length 50

# Left side of status bar
set -g status-left '#[fg=colour244,bg=colour234] tmux #[fg=colour28] #(echo ${USER})#[fg=colour82]@#h#[fg=blue]  <#S> '
set -g status-left-length 50

# Highlight the current window in the status bar (blue background)
#       #I - window index
#       #W - window title
#       #F - window flag
setw -g window-status-current-format '#[bg=blue,fg=cyan,bold] #I#[bg=blue,fg=cyan]:#[fg=white]#W#[fg=dim]#F '
setw -g window-status-format ' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '

###################################
## Messages
###################################

#set -g message-attr bold
#set -g message-fg black #colour232
#set -g message-bg red #colour166
set-option -g display-time 4000

###################################
## Plugins
###################################

set -g @plugin 'tmux-plugins/tmux-logging'
